{% extends "gallery/base.html" %}
{% load thumbnail %}
{% block content %}
    <section>
        <table>
            <tr>
                {% for post in posts %}
                    <td>
                        <a href="/gallery/post/{{ post.pk }}/">
                            <div>
                                {% thumbnail post.image "300x300" as im %}
                                    <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}"
                                         alt="{{ post.timestamp }}">
                                {% endthumbnail %}
                                <p>{{ post.timestamp }}</p>
                            </div>
                        </a>
                    </td>
                    {% if forloop.counter|divisibleby:"4" and not forloop.last %}
                        </tr>
                        <tr>
                    {% endif %}
                {% endfor %}
                </tr>
        </table>
    </section>

    <section class="pagination">
        {% if posts.has_previous %}
            <a href="?page=1">First</a>
            <a href="?page={{ posts.previous_page_number }}">Previous</a>
        {% endif %}

        {% for num in posts.paginator.page_range %}
            {% if posts.number == num %}
                <span>{{ num }}</span>
            {% elif num > posts.number|add:'-3' and num < posts.number|add:'3' %}
                <a href="?page={{ num }}">{{ num }}</a>
            {% endif %}
        {% endfor %}

        {% if posts.has_next %}
            <a href="?page={{ posts.next_page_number }}">Next</a>
        {% endif %}
    </section>
{% endblock %}